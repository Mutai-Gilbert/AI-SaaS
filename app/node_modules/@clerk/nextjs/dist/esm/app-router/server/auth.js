import { notFound, redirect } from "next/navigation";
import { buildClerkProps } from "../../server/buildClerkProps";
import { createGetAuth } from "../../server/createGetAuth";
import { authAuthHeaderMissing } from "../../server/errors";
import { buildRequestLike } from "./utils";
const auth = () => {
  const authObject = createGetAuth({
    debugLoggerName: "auth()",
    noAuthStatusMessage: authAuthHeaderMissing()
  })(buildRequestLike());
  authObject.protect = (params, options) => {
    const paramsOrFunction = params?.redirectUrl ? void 0 : params;
    const redirectUrl = params?.redirectUrl || options?.redirectUrl;
    const handleUnauthorized = () => {
      if (redirectUrl) {
        redirect(redirectUrl);
      }
      notFound();
    };
    if (!authObject.userId) {
      return handleUnauthorized();
    }
    if (!paramsOrFunction) {
      return { ...authObject };
    }
    if (typeof paramsOrFunction === "function") {
      if (paramsOrFunction(authObject.has)) {
        return { ...authObject };
      }
      return handleUnauthorized();
    }
    if (authObject.has(paramsOrFunction)) {
      return { ...authObject };
    }
    return handleUnauthorized();
  };
  return authObject;
};
const initialState = () => {
  return buildClerkProps(buildRequestLike());
};
export {
  auth,
  initialState
};
//# sourceMappingURL=auth.js.map